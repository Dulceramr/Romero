<div class="order-container">
  <form [formGroup]="orderForm" (ngSubmit)="onSubmit()" class="order-form">
    <h2>ðŸ§¾ Nueva Orden</h2>

    <!-- Selector de producto -->
    <mat-form-field appearance="outline" class="form-group">
      <mat-label>Producto</mat-label>
      <mat-select formControlName="productId" [disabled]="isLoading">
<mat-option *ngFor="let item of stockItems" [value]="item.id" [style.color]="item.color">
          <mat-icon class="option-dot" [style.color]="item.color">fiber_manual_record</mat-icon>
          {{ item.name }} ({{ item.quantity }} disponibles)
        </mat-option>
      </mat-select>
      <mat-error *ngIf="orderForm.get('productId')?.invalid && orderForm.get('productId')?.touched">
        Seleccione un producto
      </mat-error>
      <mat-progress-spinner
        *ngIf="isLoading && stockItems.length === 0"
        mode="indeterminate"
        diameter="24"
        matSuffix>
      </mat-progress-spinner>
    </mat-form-field>

    <!-- Cantidad -->
    <div class="form-group">
      <label>Cantidad:</label>
      <input type="number" formControlName="quantity" class="form-control" [disabled]="isLoading">
      <small *ngIf="orderForm.get('quantity')?.errors?.['max']" class="error-text">
        MÃ¡ximo disponible: {{getSelectedProduct()?.quantity || 0}}
      </small>
    </div>

    <!-- Destino -->
    <div class="form-group">
      <label>Destino:</label>
      <input type="text" formControlName="destination" class="form-control" [disabled]="isLoading">
      <small *ngIf="orderForm.get('destination')?.invalid && orderForm.get('destination')?.touched" class="error-text">
        Ingrese un destino vÃ¡lido
      </small>
    </div>

    <!-- Notas -->
    <div class="form-group">
      <label>Notas (opcional):</label>
      <textarea formControlName="notes" class="form-control" rows="3" [disabled]="isLoading"></textarea>
    </div>

    <!-- Botones -->
    <div class="form-actions">
      <button type="submit" class="primary-btn" [disabled]="!orderForm.valid || isLoading">
        {{ isLoading ? 'Procesando...' : 'Crear Orden' }}
      </button>
      <button type="button" class="secondary-btn" (click)="resetForm()" [disabled]="isLoading">
        Limpiar
      </button>
    </div>
  </form>
</div>